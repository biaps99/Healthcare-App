(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1383:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(1),o=a.n(c),l=a(19),s=a(9),u=a.n(s),i=a(331),m=(a(139),a(11)),d=a(67),p=a(32);a(422);function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function h(e,t,a,n,r,c,o){try{var l=e[c](o),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(n,r)}function b(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){h(c,n,r,o,l,"next",e)}function l(e){h(c,n,r,o,l,"throw",e)}o(void 0)}))}}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw c}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function E(e){var t=e.user,a=y(Object(n.useState)(e.location.state),1)[0],c=y(Object(n.useState)(!1),2),o=c[0],l=c[1],s=y(Object(n.useState)(!1),2),p=s[0],h=s[1],E=y(Object(n.useState)("Add"),2),x=E[0],k=E[1],N=y(Object(n.useState)([]),2),w=N[0],O=N[1],S=y(Object(n.useState)([]),2),j=S[0],_=S[1],P=y(Object(n.useState)([]),2),C=P[0],A=P[1],T=y(Object(n.useState)([]),2),F=T[0],R=T[1],z=y(Object(n.useState)({patient_name:"",patient_id:"",study_date:""}),2),I=z[0],D=z[1],J=y(Object(n.useState)(5),2),B=J[0],W=J[1],G=y(Object(n.useState)(0),2),L=G[0],H=G[1],U=Object(m.F)(I,250);Object(n.useEffect)((function(){(function(){var e=b(regeneratorRuntime.mark((function e(){var n,r,c,o,l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={headers:{Authorization:"JWT ".concat(localStorage.getItem("access")),"Content-Type":"application/json",Accept:"application/json"}},e.next=4,u.a.get("/api/view_studies?groupName=".concat(a,"&user=").concat(t.email),n);case 4:return r=e.sent,c=[],Object.keys(r.data.Studies).forEach((function(e){c.includes(e)||c.push(e)})),o=[],e.prev=8,e.next=11,v(t,U);case 11:l=e.sent,s=[],l.forEach((function(e){c.includes(e.study_uid)||s.includes(e)||e.user!==t.email?c.includes(e.study_uid)&&o.push(e):s.push(e)})),O(o),_(s),h(!0),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(8),alert(e.t0);case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(0),alert(e.t1);case 27:case"end":return e.stop()}}),e,null,[[0,24],[8,19]])})));return function(){return e.apply(this,arguments)}})()()}),[U,a,t,C,F]);var V=[{displayText:"PatientName",fieldName:"patient_name",inputType:"text",size:50},{displayText:"PatientId",fieldName:"patient_id",inputType:"text",size:50},{displayText:"StudyDate",fieldName:"study_date",inputType:"text",size:100}],q=V.map((function(e){return e.size})).reduce((function(e,t){return e+t}));function K(e,t){D((function(a){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(a,!0).forEach((function(t){g(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},a,g({},e,t))}))}var X=function(e){var t=e.target.value;C.includes(t)?A(C.filter((function(e){return e!==t}))):C.push(t)},M=function(){C.length<j.length?A(j.map((function(e){return e.study_uid}))):A([])};function Q(){return Y.apply(this,arguments)}function Y(){return(Y=b(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=C.length){e.next=5;break}document.getElementById("message2").textContent="At least one study must be selected!",e.next=20;break;case 5:return e.prev=5,n={headers:{Authorization:"JWT ".concat(localStorage.getItem("access")),"Content-Type":"application/json",Accept:"application/json"}},(r=new FormData).append("groupName",a),r.append("mainUser",t.email),r.append("studies",JSON.stringify(C)),e.next=13,u.a.post("/api/health_professional_add_studies",r,n);case 13:!0===e.sent.data.Status?l(!0):alert("Error while adding studies"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),alert(e.t0);case 20:case"end":return e.stop()}}),e,null,[[5,17]])})))).apply(this,arguments)}var Z=function(e){var t=e.target.value;F.includes(t)?R(F.filter((function(e){return e!==t}))):F.push(t)},$=function(){F.length<w.length?R(w.map((function(e){return e.study_uid}))):R([])};function ee(){return te.apply(this,arguments)}function te(){return(te=b(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=F.length){e.next=5;break}document.getElementById("message2").textContent="At least one study must be selected!",e.next=20;break;case 5:return e.prev=5,n={headers:{Authorization:"JWT ".concat(localStorage.getItem("access")),"Content-Type":"application/json",Accept:"application/json"}},(r=new FormData).append("groupName",a),r.append("mainUser",t.email),r.append("studies",JSON.stringify(F)),e.next=13,u.a.post("/api/health_professional_remove_studies",r,n);case 13:!0===e.sent.data.Status?l(!0):alert("Error while removing studies"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),alert(e.t0);case 20:case"end":return e.stop()}}),e,null,[[5,17]])})))).apply(this,arguments)}return localStorage.getItem("HealthProfessional_Authenticated")&&p?r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"content",style:{marginTop:"5px"}},r.a.createElement("h4",null,"Add or Remove?"),r.a.createElement("p",{className:"tooltiptext"},"Choose if you want to ",r.a.createElement("b",null,"remove")," or ",r.a.createElement("b",null,"add"),' studies from group "',a,'".'),r.a.createElement("select",{className:"select",name:"choice",value:x,onChange:function(e){return k(e.target.value)},required:!0},r.a.createElement("option",{key:""}),["Add","Remove"].map((function(e){return r.a.createElement("option",{key:e},e)}))),"Add"===x?r.a.createElement(i.a,{className:"addGroup",onSubmit:Q,render:function(e){return r.a.createElement("form",{className:"addGroup",style:{maxWidth:650},onSubmit:e.onSubmit},r.a.createElement("fieldset",{className:"k-form-fieldset"},r.a.createElement("div",{className:"mb-3"},r.a.createElement("legend",{className:"k-form-legend",style:{marginBottom:"10px",marginTop:"5px",fontSize:"14px"}},r.a.createElement("b",null,"Add studies:")),r.a.createElement("table",{className:"table"},r.a.createElement("colgroup",null,V.map((function(e,t){var a=e.size/q*100;return r.a.createElement("col",{key:t,style:{width:"".concat(a,"%"),textAlign:"center"}})}))),r.a.createElement("thead",{className:"table-head"},r.a.createElement("tr",{className:"filters"},r.a.createElement(m.y,{meta:V,values:I,onValueChange:K,sortFieldName:"patient_name",sortDirection:"asc"}),r.a.createElement("th",{style:{color:"black",paddingBottom:"15px",paddingLeft:"8px"},className:"text-left"},r.a.createElement("input",{type:"checkbox",checked:C.length===j.length,onChange:M})))),r.a.createElement("tbody",{className:"table-body"},!j.length&&r.a.createElement("tr",{style:{backgroundColor:"#5F9EA0"}},r.a.createElement("td",{colSpan:V.length},r.a.createElement("div",null,"No matching results"))),j.map((function(e){var t=e.study_uid,a=e.patient_name,n=e.patient_id,c=e.study_date;return r.a.createElement("tr",{style:{backgroundColor:"#5F9EA0"},key:t},r.a.createElement("td",{className:"text-center"},a||"Empty"),r.a.createElement("td",{className:"text-center"},n),r.a.createElement("td",{className:"text-center"},c||"Invalid date"),r.a.createElement("td",{style:{paddingLeft:"8px"}},r.a.createElement("input",{type:"checkbox",value:t,checked:C.includes(t),onChange:X})))})))),r.a.createElement(m.x,{currentPage:L,pageOptions:[5,10,15],nextPageFunc:function(){return H(L+1)},prevPageFunc:function(){return H(L-1)},onRowsPerPageChange:function(e){return W(e)},rowsPerPage:B,recordCount:j.length}),r.a.createElement("div",{className:"message",id:"message2",style:{color:"red"}}))),r.a.createElement("div",{className:"k-form-buttons"},r.a.createElement("button",{className:"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base",onClick:function(){return Q()}},"Add")))}}):"Remove"===x?r.a.createElement(i.a,{className:"addGroup",onSubmit:ee,render:function(e){return r.a.createElement("form",{className:"addGroup",style:{maxWidth:650},onSubmit:e.onSubmit},r.a.createElement("fieldset",{className:"k-form-fieldset"},r.a.createElement("div",{className:"mb-3"},r.a.createElement("legend",{className:"k-form-legend",style:{marginBottom:"10px",marginTop:"5px",fontSize:"14px"}},r.a.createElement("b",null,"Remove studies:")),r.a.createElement("table",{className:"table"},r.a.createElement("colgroup",null,V.map((function(e,t){var a=e.size/q*100;return r.a.createElement("col",{key:t,style:{width:"".concat(a,"%"),textAlign:"center"}})}))),r.a.createElement("thead",{className:"table-head"},r.a.createElement("tr",{className:"filters"},r.a.createElement(m.y,{meta:V,values:I,onValueChange:K,sortFieldName:"patient_name",sortDirection:"asc"}),r.a.createElement("th",{style:{color:"black",paddingBottom:"15px",paddingLeft:"8px"},className:"text-left"},r.a.createElement("input",{type:"checkbox",checked:F.length===w.length,onChange:$})))),r.a.createElement("tbody",{className:"table-body"},!w.length&&r.a.createElement("tr",{style:{backgroundColor:"#5F9EA0"}},r.a.createElement("td",{colSpan:V.length},r.a.createElement("div",null,"No matching results"))),w.map((function(e){var t=e.study_uid,a=e.patient_name,n=e.patient_id,c=e.study_date;return r.a.createElement("tr",{style:{backgroundColor:"#5F9EA0"},key:t},r.a.createElement("td",{className:"text-center"},a||"Empty"),r.a.createElement("td",{className:"text-center"},n),r.a.createElement("td",{className:"text-center"},c||"Invalid date"),r.a.createElement("td",{style:{paddingLeft:"8px"}},r.a.createElement("input",{type:"checkbox",value:t,checked:F.includes(t),onChange:Z})))})))),r.a.createElement(m.x,{currentPage:L,pageOptions:[5,10,15],nextPageFunc:function(){return H(L+1)},prevPageFunc:function(){return H(L-1)},onRowsPerPageChange:function(e){return W(e)},rowsPerPage:B,recordCount:j.length}),r.a.createElement("div",{className:"message",id:"message2",style:{color:"red"}}))),r.a.createElement("div",{className:"k-form-buttons"},r.a.createElement("button",{className:"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base",onClick:function(){return ee()}},"Remove")))}}):null,o?r.a.createElement(d.a,{to:"/view_studies/"+a}):r.a.createElement(n.Fragment,null))):localStorage.getItem("HealthProfessional_Authenticated")?r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"content"},o?r.a.createElement(d.a,{to:"/group_details/".concat(e.match.params.name,"/").concat(t.email)}):r.a.createElement(n.Fragment,null))):null}function v(e,t){return x.apply(this,arguments)}function x(){return(x=b(regeneratorRuntime.mark((function e(t,a){var n,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/image/?user=".concat(t.email),Object.keys(a).forEach((function(e){if(null!==a[e]&&""!==a[e]){var t=a[e];n+="&".concat(e,"=").concat(t)}})),e.next=4,u.a.get(n,{headers:{"Content-Type":"multipart/form-data",Authorization:"JWT ".concat(localStorage.getItem("access"))}}).then((function(e){return e})).catch((function(e){return e.response}));case 4:return r=e.sent,c=[],r.data.forEach((function(e){c.push(e)})),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}u.a.defaults.xsrfHeaderName="X-CSRFTOKEN",u.a.defaults.xsrfCookieName="csrftoken",u.a.defaults.withCredentials=!0,E.propTypes={user:o.a.object};t.default=Object(l.b)((function(e){return{user:e.auth.user}}),{load_user:p.g})(E)}}]);
//# sourceMappingURL=12.bundle.8cc1777e285ec44524b8.js.map